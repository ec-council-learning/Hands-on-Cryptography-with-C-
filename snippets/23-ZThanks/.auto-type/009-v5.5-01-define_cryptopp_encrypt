file: src/cryptopp.cpp
line: 12
align: top
---
⇥↓↓↓⇥
std::string ztx::cryptopp::Encrypt(const std::string& message) {
  std::string cipher, output;

  // Encrypt using AES-256 and password
  CryptoPP::StringSource enc_source(message, true, new CryptoPP::DefaultEncryptor(
    "Hands-On Cryptography with C++",
    new CryptoPP::StringSink(cipher)
  ));

  // Format the ciphertext with base64
  CryptoPP::StringSource b64_source(cipher, true,  new CryptoPP::Base64Encoder(
    new CryptoPP::StringSink(output),
    false // no line breaks
  ));

  return output.c_str();
}