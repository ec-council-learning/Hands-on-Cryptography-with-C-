file: src/botan.cpp
line: 11
align: top
---
⇥↓↓↓⇥
std::string ztx::botan::Encrypt(const std::string& message) {
  // Compute sha-256 of password to use as key
  auto hash = Botan::HashFunction::create_or_throw("SHA-256");
  hash->update("Hands-On Cryptography with C++");
  auto key = hash->final();

  // Uses a sha-256 hash of the password as the key
  Botan::SymmetricKey k(key);

  // Encrypts using Camellia-256 and hash of password
  Botan::Pipe pipe(
    Botan::get_cipher("Camellia-256/CBC", k, Botan::Cipher_Dir::Encryption),
    new Botan::Base64_Encoder
  );

  pipe.process_msg(message);
  return pipe.read_all_as_string();
}